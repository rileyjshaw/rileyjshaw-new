{"version":3,"sources":["webpack:///./src/components/doodles/riot.js","webpack:///./src/components/grid-doodles.js","webpack:///./src/components/project-explorer.js","webpack:///./src/pages/lab.js"],"names":["Riot","_","ref","useViewport","updateOnScroll","riotRef","boundingClientRect","windowHeight","useDomMethod","oRef","oBoundingClientRect","factor","top","height","Math","abs","transformOrigin","useMemo","left","width","hasOwnProperty","className","Array","from","length","i","key","style","map","p","join","transform","React","forwardRef","props","El","split","letter","animationDelay","size","classPrefix","OuterElement","ms","month","Date","getMonth","today","getDate","Component","chance","fn","random","ProjectExplorer","memo","nodeTypes","Set","nodes","n","type","sort","a","b","localeCompare","sortingMethods","version","useState","drawerOpen","setDrawerOpen","useStickyState","STORAGE_KEYS","labAscending","ascending","setAscending","labSortIdx","sortIdx","setSortIdx","fill","labTypeStates","serverState","typeStates","setTypeStates","nSources","reduce","sortFn","checkedTypeNames","filter","node","includes","partitions","push","doodles","sorted","ordered","reverse","forEach","doodle","shouldRender","rest","splice","floor","onClick","openState","name","id","value","checked","onChange","e","target","prevTypeStates","updatedTypeStates","htmlFor","contentTypes","readableType","title","toUpperCase","slice","LazyGrid","setIsFullyLoaded","renderLimit","setRenderLimit","useInView","inView","entry","useEffect","bottom","l","masonry","lazyLoadRef","ProjectExplorerWrapper","tags","useStaticQuery","allTagsJson","allProjects","allProjectsQuery","concat","gridDoodles","uid","Doodle","LabPage","isFullyLoaded","quoteId"],"mappings":"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","file":"component---src-pages-lab-js-1a4922fa089ae901933c.js","sourcesContent":["import {useViewport, useDomMethod} from '../../util/hooks';\nimport './riot.css';\nimport React, {useMemo} from 'react';\n\nfunction Riot(_, ref) {\n\tconst [\n\t\triotRef,\n\t\t_inView,\n\t\tboundingClientRect,\n\t\twindowHeight = 0,\n\t] = useViewport({updateOnScroll: true});\n\tconst [oRef, oBoundingClientRect] = useDomMethod('getBoundingClientRect');\n\tlet factor = boundingClientRect\n\t\t? (1 -\n\t\t\t\t(boundingClientRect.top + boundingClientRect.height) /\n\t\t\t\t\t(windowHeight + boundingClientRect.height) -\n\t\t\t\t0.5) *\n\t\t  2\n\t\t: 0;\n\tif (factor) factor *= Math.abs(factor);\n\n\tconst transformOrigin = useMemo(\n\t\t() =>\n\t\t\toBoundingClientRect\n\t\t\t\t? [\n\t\t\t\t\t\t(oBoundingClientRect.left +\n\t\t\t\t\t\t\toBoundingClientRect.width / 2 -\n\t\t\t\t\t\t\tboundingClientRect.left) /\n\t\t\t\t\t\t\tboundingClientRect.width,\n\t\t\t\t\t\t(oBoundingClientRect.top +\n\t\t\t\t\t\t\toBoundingClientRect.height / 2 -\n\t\t\t\t\t\t\tboundingClientRect.top) /\n\t\t\t\t\t\t\tboundingClientRect.height,\n\t\t\t\t  ]\n\t\t\t\t: [0.5, 0.5],\n\t\t[oBoundingClientRect]\n\t);\n\n\treturn (\n\t\t<div\n\t\t\t{...(ref?.hasOwnProperty('current') ? {ref} : {})}\n\t\t\tclassName=\"content-node doodle doodle-riot\"\n\t\t>\n\t\t\t{Array.from({length: 6}, (_, i) => (\n\t\t\t\t<p\n\t\t\t\t\tref={i ? null : riotRef}\n\t\t\t\t\tkey={`riot-${i}`}\n\t\t\t\t\tclassName=\"riot-overlay\"\n\t\t\t\t\tstyle={{\n\t\t\t\t\t\ttransformOrigin: transformOrigin\n\t\t\t\t\t\t\t.map(p => `${p * 100}%`)\n\t\t\t\t\t\t\t.join(' '),\n\t\t\t\t\t\ttransform: `translate(-50%, -50%) rotate(${\n\t\t\t\t\t\t\ti * factor * 30\n\t\t\t\t\t\t}deg)`,\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\tRI<span ref={i ? null : oRef}>O</span>T!\n\t\t\t\t</p>\n\t\t\t))}\n\t\t</div>\n\t);\n}\n\nexport default Riot;\n","import CycleText from './cycle-text';\nimport BackgroundGenerator from './doodles/background-generator';\nimport CircleConstrainedLines from './doodles/circle-constrained-lines';\nimport GameOver from './doodles/game-over';\nimport Riot from './doodles/riot';\nimport './grid-doodles.css';\nimport TextGrid from './text-grid';\nimport React from 'react';\n\nexport default [\n\t[\n\t\tReact.forwardRef((props, ref) => (\n\t\t\t<BackgroundGenerator El=\"li\" ref={ref} />\n\t\t)),\n\t\t0.8,\n\t],\n\t[\n\t\tReact.forwardRef((props, ref) => (\n\t\t\t<CircleConstrainedLines El=\"li\" ref={ref} />\n\t\t)),\n\t\t0.8,\n\t],\n\t[React.forwardRef((props, ref) => <GameOver ref={ref} />), 0.8],\n\t[React.forwardRef((props, ref) => <Riot ref={ref} />), 1],\n\t[\n\t\tReact.forwardRef((props, ref) => (\n\t\t\t<li className=\"doodle wavytext\" ref={ref}>\n\t\t\t\t{'rileyjshaw'.split('').map((letter, i, {length}) => (\n\t\t\t\t\t<span\n\t\t\t\t\t\tkey={i}\n\t\t\t\t\t\tstyle={{animationDelay: `${(i - length) * 0.2}s`}}\n\t\t\t\t\t>\n\t\t\t\t\t\t{letter}\n\t\t\t\t\t</span>\n\t\t\t\t))}\n\t\t\t</li>\n\t\t)),\n\t\t0.2,\n\t],\n\t[\n\t\tReact.forwardRef((props, ref) => (\n\t\t\t<TextGrid\n\t\t\t\tsize={[3, 3]}\n\t\t\t\tclassPrefix=\"doingreat\"\n\t\t\t\tclassName=\"content-node doodle\"\n\t\t\t\tOuterElement=\"li\"\n\t\t\t\tref={ref}\n\t\t\t>\n\t\t\t\tDOINGREAT\n\t\t\t</TextGrid>\n\t\t)),\n\t\t0.1,\n\t],\n\t[\n\t\tReact.forwardRef((props, ref) => (\n\t\t\t<CycleText\n\t\t\t\tclassPrefix=\"wavebump\"\n\t\t\t\tclassName=\"content-node doodle\"\n\t\t\t\tms={50}\n\t\t\t\tOuterElement=\"li\"\n\t\t\t\tref={ref}\n\t\t\t>\n\t\t\t\t▁▂▃▅▆▇▇▆▅▃▂▁\n\t\t\t</CycleText>\n\t\t)),\n\t\t0.3,\n\t],\n\t[\n\t\tReact.forwardRef((props, ref) => (\n\t\t\t<CycleText\n\t\t\t\tclassPrefix=\"droplet\"\n\t\t\t\tclassName=\"content-node doodle\"\n\t\t\t\tms={150}\n\t\t\t\tOuterElement=\"li\"\n\t\t\t\tref={ref}\n\t\t\t>\n\t\t\t\t⊙⊚⦾⊛\n\t\t\t</CycleText>\n\t\t)),\n\t\t0.2,\n\t],\n\t[\n\t\tReact.forwardRef((props, ref) => (\n\t\t\t<CycleText\n\t\t\t\tclassPrefix=\"circles\"\n\t\t\t\tclassName=\"content-node doodle\"\n\t\t\t\tms={100}\n\t\t\t\tsize={[2, 2]}\n\t\t\t\tOuterElement=\"li\"\n\t\t\t\tref={ref}\n\t\t\t>\n\t\t\t\t◯⦿◉◎\n\t\t\t</CycleText>\n\t\t)),\n\t\t0.2,\n\t],\n\t[\n\t\tReact.forwardRef((props, ref) => (\n\t\t\t<li className=\"content-node snowman doodle\" ref={ref}>\n\t\t\t\t☃\n\t\t\t</li>\n\t\t)),\n\t\t0.3,\n\t\t() => {\n\t\t\tconst month = new Date().getMonth();\n\t\t\treturn month < 4 || month === 11;\n\t\t},\n\t],\n\t[\n\t\tReact.forwardRef((props, ref) => (\n\t\t\t<CycleText\n\t\t\t\tclassPrefix=\"wavebump\"\n\t\t\t\tclassName=\"content-node tall doodle\"\n\t\t\t\tms={400}\n\t\t\t\tOuterElement=\"li\"\n\t\t\t\tref={ref}\n\t\t\t>\n\t\t\t\tSecret message!\n\t\t\t</CycleText>\n\t\t)),\n\t\t0.05,\n\t\t() => {\n\t\t\tconst today = new Date();\n\t\t\treturn today.getMonth() === 11 && today.getDate() === 25;\n\t\t},\n\t],\n].map(([Component, chance, fn]) => [\n\tComponent,\n\tfn ? () => fn() || Math.random() < chance : () => Math.random() < chance,\n]);\n","// TODO(RILEY): https://tympanus.net/Development/TiltHoverEffects/index.html\nimport allProjectsQuery from '../util/all-projects-query';\nimport {STORAGE_KEYS} from '../util/constants';\nimport contentTypes from '../util/content-types';\nimport {useInView, useStickyState} from '../util/hooks';\nimport sortingMethods, {shuffle} from '../util/sorting-methods';\nimport ContentGrid from './content-grid';\nimport gridDoodles from './grid-doodles';\nimport './project-explorer.css';\nimport {useStaticQuery, graphql} from 'gatsby';\nimport React, {Fragment, useState, useEffect, useMemo} from 'react';\n\nconst ProjectExplorer = React.memo(function ProjectExplorer(props) {\n\tconst [nodeTypes, version] = useMemo(() => {\n\t\tconst nodeTypes = Array.from(\n\t\t\tnew Set(props.nodes.map(n => n.type))\n\t\t).sort((a, b) => a.localeCompare(b));\n\t\treturn [nodeTypes, `${nodeTypes.join('')}${sortingMethods.length}`];\n\t}, [props.nodes]);\n\n\tconst [drawerOpen, setDrawerOpen] = useState(false);\n\tconst [ascending, setAscending] = useStickyState(\n\t\tfalse,\n\t\tSTORAGE_KEYS.labAscending,\n\t\t{version}\n\t);\n\tconst [sortIdx, setSortIdx] = useStickyState(0, STORAGE_KEYS.labSortIdx, {\n\t\tversion,\n\t});\n\tconst [typeStates, setTypeStates] = useStickyState(\n\t\t() => Array.from(nodeTypes).fill(true),\n\t\tSTORAGE_KEYS.labTypeStates,\n\t\t{version, serverState: []}\n\t);\n\n\tconst nSources =\n\t\ttypeStates.reduce((a, b) => a + b, 0) || typeStates.length;\n\n\tconst nodes = useMemo(() => {\n\t\tif (!typeStates.length) return null;\n\t\tconst {sortFn} = sortingMethods[sortIdx];\n\t\tconst checkedTypeNames = nodeTypes.filter((_, i) => typeStates[i]);\n\t\tconst [doodles, filtered] = (checkedTypeNames.length\n\t\t\t? props.nodes.filter(node => checkedTypeNames.includes(node.type))\n\t\t\t: props.nodes\n\t\t).reduce(\n\t\t\t(partitions, node) => {\n\t\t\t\tpartitions[node.type === 'doodle' ? 0 : 1].push(node);\n\t\t\t\treturn partitions;\n\t\t\t},\n\t\t\t[[], []]\n\t\t);\n\t\tconst sorted = sortFn(filtered);\n\t\tconst ordered = ascending ? sorted.reverse() : sorted;\n\t\t// Insert a few doodles into a random position.\n\t\tdoodles.forEach(doodle => {\n\t\t\tconst {shouldRender, ...rest} = doodle;\n\t\t\tif (shouldRender()) {\n\t\t\t\tordered.splice(\n\t\t\t\t\tMath.floor(Math.random() * ordered.length),\n\t\t\t\t\t0,\n\t\t\t\t\trest\n\t\t\t\t);\n\t\t\t}\n\t\t});\n\t\treturn ordered;\n\t}, [ascending, sortIdx, typeStates, props.nodes]);\n\n\treturn (\n\t\tnodes && (\n\t\t\t<div className=\"project-explorer\">\n\t\t\t\t<button\n\t\t\t\t\tclassName=\"project-explorer-hide-filters\"\n\t\t\t\t\tonClick={() => setDrawerOpen(openState => !openState)}\n\t\t\t\t>\n\t\t\t\t\t{drawerOpen ? 'Hide filters ▲' : 'Show filters ▼'}\n\t\t\t\t</button>\n\t\t\t\t<div className=\"filters\">\n\t\t\t\t\t{drawerOpen && (\n\t\t\t\t\t\t/* TODO(riley): Once display: contents or display:\n\t\t\t\tsubgrid have good support, replace <p.legend> with\n\t\t\t\t<legend>, get rid of the .inputs wrappers, and nest\n\t\t\t\t<fieldset>s (display: contents) around each <legend> /\n\t\t\t\t.inputs / button set. Until then, the children need to\n\t\t\t\tbe direct descendents of the grid, and a11y takes a\n\t\t\t\thit. */\n\t\t\t\t\t\t<div className=\"controls\">\n\t\t\t\t\t\t\t<p className=\"legend\">Show:</p>\n\t\t\t\t\t\t\t<div className=\"inputs\">\n\t\t\t\t\t\t\t\t{nodeTypes.map((type, i) => (\n\t\t\t\t\t\t\t\t\t<Fragment key={type}>\n\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\t\t\t\tname={`labs-types-${type}`}\n\t\t\t\t\t\t\t\t\t\t\tid={`labs-types-${type}`}\n\t\t\t\t\t\t\t\t\t\t\tvalue={type}\n\t\t\t\t\t\t\t\t\t\t\tchecked={typeStates[i]}\n\t\t\t\t\t\t\t\t\t\t\tonChange={e => {\n\t\t\t\t\t\t\t\t\t\t\t\tconst {checked} = e.target;\n\t\t\t\t\t\t\t\t\t\t\t\tsetTypeStates(\n\t\t\t\t\t\t\t\t\t\t\t\t\tprevTypeStates => {\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tconst updatedTypeStates = [\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t...prevTypeStates,\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t];\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tupdatedTypeStates[\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\ti\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t] = checked;\n\t\t\t\t\t\t\t\t\t\t\t\t\t\treturn updatedTypeStates;\n\t\t\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t<label htmlFor={`labs-types-${type}`}>\n\t\t\t\t\t\t\t\t\t\t\t{contentTypes[type].readableType}s\n\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<button\n\t\t\t\t\t\t\t\tclassName=\"labs-clear labs-clear-types\"\n\t\t\t\t\t\t\t\tonClick={() =>\n\t\t\t\t\t\t\t\t\tsetTypeStates(\n\t\t\t\t\t\t\t\t\t\tnew Array(nodeTypes.length).fill(false)\n\t\t\t\t\t\t\t\t\t)\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t✖\n\t\t\t\t\t\t\t</button>\n\t\t\t\t\t\t\t<p className=\"legend\">Sort by:</p>\n\t\t\t\t\t\t\t<div className=\"inputs\">\n\t\t\t\t\t\t\t\t{sortingMethods.map(({title}, i) => (\n\t\t\t\t\t\t\t\t\t<Fragment key={title}>\n\t\t\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\t\t\ttype=\"radio\"\n\t\t\t\t\t\t\t\t\t\t\tname={`labs-sort-${title}`}\n\t\t\t\t\t\t\t\t\t\t\tid={`labs-sort-${title}`}\n\t\t\t\t\t\t\t\t\t\t\tvalue={title}\n\t\t\t\t\t\t\t\t\t\t\tchecked={sortIdx === i}\n\t\t\t\t\t\t\t\t\t\t\tonChange={() => setSortIdx(i)}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t<label htmlFor={`labs-sort-${title}`}>\n\t\t\t\t\t\t\t\t\t\t\t{title.toUpperCase().slice(0, 1) +\n\t\t\t\t\t\t\t\t\t\t\t\ttitle.slice(1)}\n\t\t\t\t\t\t\t\t\t\t</label>\n\t\t\t\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t<p className=\"legend\">Order:</p>\n\t\t\t\t\t\t\t<div className=\"inputs\">\n\t\t\t\t\t\t\t\t<input\n\t\t\t\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\t\t\t\tname=\"labs-order\"\n\t\t\t\t\t\t\t\t\tid=\"labs-order\"\n\t\t\t\t\t\t\t\t\tvalue=\"ascending\"\n\t\t\t\t\t\t\t\t\tchecked={ascending}\n\t\t\t\t\t\t\t\t\tonChange={e =>\n\t\t\t\t\t\t\t\t\t\tsetAscending(e.target.checked)\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<label htmlFor=\"labs-order\">Reverse</label>\n\t\t\t\t\t\t\t\t{/* TODO: Add the shuffle button back here!\n\n\t\t\t\t\t\t\t<button onClick={this.shuffleDisplayNodes}>\n\t\t\t\t\t\t\t\tShuffle\n\t\t\t\t\t\t\t</button> */}\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t)}\n\t\t\t\t</div>\n\t\t\t\t<p className=\"result-details\">\n\t\t\t\t\tFound <strong>{nodes.length}</strong> entries from{' '}\n\t\t\t\t\t<strong>{nSources}</strong> source\n\t\t\t\t\t{nSources === 1 ? '' : 's'}:\n\t\t\t\t</p>\n\t\t\t\t<LazyGrid\n\t\t\t\t\tnodes={nodes}\n\t\t\t\t\tsetIsFullyLoaded={props.setIsFullyLoaded}\n\t\t\t\t/>\n\t\t\t</div>\n\t\t)\n\t);\n});\n\n// TODO(riley): Ensure this lazy-loading works with a screen reader.\nconst LazyGrid = React.memo(({nodes, setIsFullyLoaded}) => {\n\tconst [renderLimit, setRenderLimit] = useState(20);\n\tconst [ref, inView, entry] = useInView();\n\n\t// TODO: The “or above” check doesn’t actually work…\n\t// If the last node is on or above the viewport, load the next 20 nodes.\n\t// Note that the “last” node might be higher up on the page, eg. if it has\n\t// a small footprint and squeezes into some top row masonry. Hence the on\n\t// *or above* the viewport check.\n\tuseEffect(() => {\n\t\tif (\n\t\t\t(inView || (entry?.boundingClientRect?.bottom ?? 1) <= 0) &&\n\t\t\trenderLimit < nodes.length\n\t\t) {\n\t\t\tsetRenderLimit(l => l + 20);\n\t\t}\n\t}, [inView, entry?.boundingClientRect?.bottom]);\n\n\tuseEffect(() => {\n\t\tsetRenderLimit(20);\n\t}, [nodes]);\n\n\tuseEffect(() => {\n\t\tsetIsFullyLoaded && setIsFullyLoaded(renderLimit >= nodes.length);\n\t}, [nodes.length, renderLimit]);\n\n\treturn (\n\t\t<ContentGrid\n\t\t\tmasonry\n\t\t\tnodes={nodes.slice(0, renderLimit)}\n\t\t\tlazyLoadRef={ref}\n\t\t/>\n\t);\n});\n\nconst ProjectExplorerWrapper = React.memo(props => {\n\tconst {\n\t\tallTagsJson: {nodes: tags},\n\t} = useStaticQuery(graphql`\n\t\t{\n\t\t\tallTagsJson {\n\t\t\t\tnodes {\n\t\t\t\t\tname\n\t\t\t\t\treadable\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t`);\n\tconst allProjects = allProjectsQuery();\n\tconst nodes = useMemo(\n\t\t() =>\n\t\t\tallProjects.concat(\n\t\t\t\tgridDoodles.map(([Doodle, shouldRender], i) => ({\n\t\t\t\t\tuid: `DOODLE_${i}`,\n\t\t\t\t\ttype: 'doodle',\n\t\t\t\t\tDoodle,\n\t\t\t\t\tshouldRender,\n\t\t\t\t}))\n\t\t\t),\n\t\t[allProjects]\n\t);\n\n\treturn <ProjectExplorer nodes={nodes} tags={tags} {...props} />;\n});\n\nexport default ProjectExplorerWrapper;\n\n/* Big TODO: Once tags are established and applied to each content node (lots\n   of manual work required before that happens), get filtering by tag back into\n   the component. Here’s an old snippet:\n\n\t\tconst filtered = checkedTagNames.length\n\t\t\t? filteredByType.filter(node =>\n\t\t\t\t\tcheckedTagNames[\n\t\t\t\t\t\tstate.filterType === 'any' ? 'some' : 'every'\n\t\t\t\t\t](tagName => node.tags && node.tags.includes(tagName))\n\t\t\t  )\n\t\t\t: filteredByType;\n\n\t\t// …\n\t\t// …then for the render:\n\t\t// …\n\n\t\t<p className=\"legend\">Match:</p>\n\t\t<div className=\"inputs\">\n\t\t\t<input\n\t\t\t\ttype=\"radio\"\n\t\t\t\tname=\"labs-filter-any\"\n\t\t\t\tid=\"labs-filter-any\"\n\t\t\t\tvalue=\"any\"\n\t\t\t\tchecked={this.state.filterType === 'any'}\n\t\t\t\tonChange={this.handleFilterTypeChange}\n\t\t\t/>\n\t\t\t<label htmlFor=\"labs-filter-any\">Any</label>\n\t\t\t|\n\t\t\t<input\n\t\t\t\ttype=\"radio\"\n\t\t\t\tname=\"labs-filter-all\"\n\t\t\t\tid=\"labs-filter-all\"\n\t\t\t\tvalue=\"all\"\n\t\t\t\tchecked={this.state.filterType === 'all'}\n\t\t\t\tonChange={this.handleFilterTypeChange}\n\t\t\t/>\n\t\t\t<label htmlFor=\"labs-filter-all\">All</label>\n\t\t</div>\n\t\t<p className=\"legend\">Of:</p>\n\t\t<div className=\"inputs\">\n\t\t\t{tags.map((tag, i) => (\n\t\t\t\t<Fragment key={tag.name}>\n\t\t\t\t\t<input\n\t\t\t\t\t\ttype=\"checkbox\"\n\t\t\t\t\t\tname={`labs-tags-${tag.name}`}\n\t\t\t\t\t\tid={`labs-tags-${tag.name}`}\n\t\t\t\t\t\tvalue={tag.name}\n\t\t\t\t\t\tchecked={this.state.tagStates[i]}\n\t\t\t\t\t\tonChange={e =>\n\t\t\t\t\t\t\tthis.handleTagStateChange(e, i)\n\t\t\t\t\t\t}\n\t\t\t\t\t/>\n\t\t\t\t\t<label\n\t\t\t\t\t\thtmlFor={`labs-tags-${tag.name}`}\n\t\t\t\t\t>\n\t\t\t\t\t\t{tag.readable}\n\t\t\t\t\t</label>\n\t\t\t\t</Fragment>\n\t\t\t))}\n\t\t</div>\n\t\t<button\n\t\t\tclassName=\"labs-clear labs-clear-tags\"\n\t\t\tonClick={this.handleClearTagsClick}\n\t\t>\n\t\t\t✖\n\t\t</button>\n*/\n","import BigQuote from '../components/big-quote';\nimport GoUp from '../components/go-up';\nimport ProjectExplorer from '../components/project-explorer';\nimport SEO from '../components/seo';\nimport React, {useState} from 'react';\n\nconst LabPage = () => {\n\tconst [isFullyLoaded, setIsFullyLoaded] = useState(false);\n\n\treturn (\n\t\t<>\n\t\t\t<SEO title=\"Lab\" />\n\t\t\t<ProjectExplorer setIsFullyLoaded={setIsFullyLoaded} />\n\t\t\t{isFullyLoaded && (\n\t\t\t\t<>\n\t\t\t\t\t<BigQuote quoteId=\"VOLTAIRE_BORING\" />\n\t\t\t\t\t<GoUp />\n\t\t\t\t</>\n\t\t\t)}\n\t\t</>\n\t);\n};\n\nexport default LabPage;\n"],"sourceRoot":""}