{"version":3,"file":"component---src-templates-post-js-content-file-path-users-lamp-code-rileyjshaw-src-data-markdown-posts-published-2014-11-12-stealing-history-with-css-binary-trees-mdx-c6307ce9f8a166f86ea0.js","mappings":"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","sources":["webpack://rileyjshaw.com/./src/data/markdown/posts/published/2014-11-12-stealing-history-with-CSS-binary-trees.mdx","webpack://rileyjshaw.com/./src/templates/post.js","webpack://rileyjshaw.com/./src/components/blog-banner.js","webpack://rileyjshaw.com/./src/components/figure.js","webpack://rileyjshaw.com/./src/components/seo.js"],"sourcesContent":["/*@jsxRuntime classic @jsx React.createElement @jsxFrag React.Fragment*/\nimport {useMDXComponents as _provideComponents} from \"@mdx-js/react\";\nimport React from \"react\";\nimport BlogBanner from 'components/blog-banner';\nimport Figure from 'components/figure';\nfunction _createMdxContent(props) {\n  const _components = Object.assign({\n    p: \"p\",\n    a: \"a\",\n    h2: \"h2\",\n    div: \"div\",\n    em: \"em\",\n    ul: \"ul\",\n    li: \"li\"\n  }, _provideComponents(), props.components);\n  return React.createElement(React.Fragment, null, React.createElement(BlogBanner, {\n    type: \"update\",\n    date: \"2015-01-21\"\n  }, React.createElement(_components.p, null, \"Since writing this post, Chrome and Firefox have changed their\\nalpha-blending functions. Demos likely won’t work anymore. This is good\\nnews!\")), \"\\n\", React.createElement(_components.p, null, \"History-sniffing attacks let front-end code peek at other sites you’ve visited. They can be used to target ads, steal information, or discern your identity. Creepy.\"), \"\\n\", React.createElement(_components.p, null, \"Historically, one of the most popular history-sniffing techniques was to style \", React.createElement(\"code\", {\n    className: \"language-css\"\n  }, \":visited\"), \" links using CSS and check their color with JavaScript. Major browsers started implementing \", React.createElement(_components.a, {\n    href: \"https://hacks.mozilla.org/2010/03/privacy-related-changes-coming-to-css-vistited/\"\n  }, \"privacy changes\"), \" to address this attack in 2010.[^1] As a result, JavaScript’s \", React.createElement(\"code\", {\n    className: \"language-javascript\"\n  }, \"getComputedStyle\"), \" now returns unvisited styles for visited sites.\"), \"\\n\", React.createElement(_components.p, null, \"Even with these limitations there are a number of ways to scrape a user’s history. The remainder of this article describes a combination of tricks used to do so. The outcome is a proof-of-concept \", React.createElement(_components.a, {\n    href: \"/visited-vectors/reaction/\"\n  }, \"history-sniffing game\"), \".\"), \"\\n\", React.createElement(_components.h2, {\n    id: \"trick-1-clicking-colors\",\n    style: {\n      position: \"relative\"\n    }\n  }, React.createElement(_components.a, {\n    href: \"#trick-1-clicking-colors\",\n    \"aria-label\": \"trick 1 clicking colors permalink\",\n    className: \"anchor before\"\n  }, React.createElement(_components.div, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  })), \"Trick #1: Clicking colors\"), \"\\n\", React.createElement(_components.p, null, \"Though \", React.createElement(\"code\", {\n    className: \"language-javascript\"\n  }, \"getComputedStyle\"), \" is a dead-end, sniffers can trick \", React.createElement(_components.em, null, \"users\"), \" into telling a script which links they’ve visited. \", React.createElement(_components.a, {\n    href: \"http://tinsnail.neocities.org/\"\n  }, \"This demo\"), \" is the clearest implementation that I’ve seen; the site shows a grid of styled links and asks you to click the red ones.\"), \"\\n\", React.createElement(_components.p, null, \"I saw the demo above while working on an unrelated game. The game asked players to hit the spacebar when a box turned red.\"), \"\\n\", React.createElement(_components.div, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 241px; \\\"\\n    >\\n      <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/b5970e182bf26a4d74b659409d1f1283/2f862/reaction1.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n    <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 254.43786982248523%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAzCAIAAAAYQr/UAAAACXBIWXMAAAsTAAALEwEAmpwYAAADXklEQVRIx+1Wy07jSBT1n7BD4gP4AlbsYclvsENsEBISq8CCDhLSNAuElAUSzYhhZhqFNEo7wXbHFoljpx9JiKsSP4gr2PGrfHsSMyiku2dgMqPZcFalsk/dc++t0j0MABDbLrCFIAwlsYTa2DANQuyrYtHt9wHg1jKJ3ZMkCeE2DMHzvOO6AMAAQL/fxwjRiPIcpyGEMHIc56pYwO0OAJh6x7Z7cqVcVVQA8Lz+xUU2OYhJDovjeGwBD4s/9yl9tDMg+76/srIiimI+n9/Z2QGAg4MD3/fPz89PTk4wxmtra6qq5vN5jHEqlapUKvl8fmtrCyHEEEJmZmYODw93d3cXFhZ0XZ+dnWVZdmNjI5VKeZ63urqKENre3mZZdn5+PpPJ7O3tTU1NCYLAhGHYbDYtyzIMQ1EUQki9Xtd1vdfrKYoCAJZlRVFkmialVJZl13Vt29Y0zXEcZiwNSqNutwsAjuPElDqOQ2w7iuitZRHSGy3BfcEopcN6UABo1Ou5XC4Igre///b5S12pVl//9Fo3LPb9+7ZuJrTk5ziOxyMHQaAoSr/vWZZ1d3fned7tQDbVWq3boaJ4pAvj5GdhnPygf7TzcXyf2t+QJ4r8PDKdAJNFFgShVqspz4SqqqIoMpeXl77vd7td8mTYtu26bqVSYSRJSi7Z09UmPWu1WkypVPpn5JubmxfyC/mF/K+TJ3rPLMsm891/MjzPo5TWarUBWVVVWZarz4GqqjzPM/EEYL4dIk/P/H8cNz+SNDolv/VB/818HnhCQjqdTtJSXdfrjeaYJ/gOOY7jMAwBQJblXO6dZVrNRuOO2LJSA4Aoisb4P5QdBMHADfzltX1kHxFC5XI5DMNsNksI6Xa7GGMAYFnWcRxJkqrV6qj+e3KiNp1+NTc3p2na9PS0KIrr6+vLy8vX19dLS0uEkMXFxc3NzUT/I3LyqjiOS6fTnU4nl8sBwPHx8dHRkWma+/v7lmVlMpmzs1+Hke9zYR4c2cN53y1s8jWKojCMoijyfX8YOY4Fnnvz5mfXdQXuSpTKGGmFIhcEwdnp6Uf1U2Ilfzk7NUyT44qNxg3CGlsoBkEwkP1RVbMXOUqjZqOOcMcwjHJFjiktffjw+dOXpPK8wDuOW5VlhNu4jUsl8Q9D8xWwOVjE8nQNJQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"Interface for a simple reaction game\\\"\\n        title=\\\"Interface for a simple reaction game\\\"\\n        src=\\\"/static/b5970e182bf26a4d74b659409d1f1283/2f862/reaction1.png\\\"\\n        srcset=\\\"/static/b5970e182bf26a4d74b659409d1f1283/d23e3/reaction1.png 169w,\\n/static/b5970e182bf26a4d74b659409d1f1283/2f862/reaction1.png 241w\\\"\\n        sizes=\\\"(max-width: 241px) 100vw, 241px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n  </a>\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, React.createElement(_components.em, null, \"“Hey”\"), \", I thought to myself, \", React.createElement(_components.em, null, \"“this game could be so much more sneaky!”\")), \"\\n\", React.createElement(_components.p, null, \"I swapped the box out for a stack of links and styled \", React.createElement(\"code\", {\n    className: \"language-css\"\n  }, \":visited\"), \" to \", React.createElement(\"code\", {\n    className: \"language-css\"\n  }, \"background-color:red\"), \". It was totally evil and awesome and ready to go!\"), \"\\n\", React.createElement(_components.div, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 241px; \\\"\\n    >\\n      <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/06e27a316663bc24564927d635022c84/2f862/reaction2.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n    <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 177.5147928994083%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAkCAIAAAAGkY33AAAACXBIWXMAAAsTAAALEwEAmpwYAAACRElEQVRIx91Tu27TUBj+PEbtI1Seu2XgARAZEBuILU+QF2DJmDkSE1KExNyKiA6IJU0aIUgqRU1KRCU3FDtyboWkDrk4Vn05N6jdRA2qwE1h6a9PR9bv813Obx+UNzc7GxuaLDdDQ5PlliwfyjK0SEQADBChwf3VAKCurwuASBILDSpJQpL6kgRtbW015zPgjpAZQH2w+TOZd2h4Zz7fFMo54H8AtoBtoAQowD7wGngLvAfKy6JL5CDVM+AB8Bx4CNwDngBPgUfAfeDxlaP9Tg70qsAB8AJ4BbwE3gGngA7UgdoK0+bhp70Y9WLOi7Gzu/qH3Yzc9O8z869oSHB/NSQJR5EIAUzACo0Z4PgfH8fF4snu7kk+f1Mc5/MQtygwSvlKYJTezvm/kDnn/8D5Dyq4duvgbNDrdG3bMafT015X1ZrXqiyRGWOEECHE0dHn/VLJNK1etzsdj771B0IISiljLGxs7tffzxxI1uv1XC7num4mkxkMBrquK4rCOc9ms+PxuOjX1fyX5CBtOp2OxWK6rkej0WazmUwmE4mEoijxeHw2m8Xj8VQqFeRfIgdiqqoWCoXJZKJpmhCi6pfjOEHz4KBaqVQWMS/JhBDLsjjn1PcPtGzb5pwzxjzPE0K4rsvnrxzHCZJekA3DqNZqxPP29oqBp2WaO292hj9G5dJHvdXu978f1j8559bW1rZlndeq1Xa7c0n2PG9qTgXnjcaX0Wh00XFd9atq20671TIMgxAyNU1KSaPRIJQOjaFt27/IPwHgEAOW3PQsegAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"Score displaying with red background\\\"\\n        title=\\\"Score displaying with red background\\\"\\n        src=\\\"/static/06e27a316663bc24564927d635022c84/2f862/reaction2.png\\\"\\n        srcset=\\\"/static/06e27a316663bc24564927d635022c84/d23e3/reaction2.png 169w,\\n/static/06e27a316663bc24564927d635022c84/2f862/reaction2.png 241w\\\"\\n        sizes=\\\"(max-width: 241px) 100vw, 241px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n  </a>\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"…almost.\"), \"\\n\", React.createElement(_components.div, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 241px; \\\"\\n    >\\n      <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/cc4d5fe240197dbd3c878ecdc8ceb629/2f862/reaction3.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n    <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 177.5147928994083%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAkCAIAAAAGkY33AAAACXBIWXMAAAsTAAALEwEAmpwYAAACR0lEQVRIx92VzYraUBTH80YufABREHcK7vIEvoCbWboW3LgQcW9ROgtxIziD2CiIiQ0Vom2TmPjVqrF+JGHycZN723pnRKczog7dzH95c3/nf87hnBui0WiMRiNBEMSzJQiCLMudTocQBAEh5LouOlsQQoSQoigEz/MIIQCAe7Ycx0EIzWaz650Xi8U7gXE/HMfZ9wYA4DzpXGe407nOmK/X6/mdKIriOK7ZbBYKhVKpVKvVKIo6DHoE46zi8bjf70+lUsFg0Ov1RiKRaDQaCoV8Pl84HN6X9hzG8Wiabrfb6XQ6l8tls9lyuTydTgeDAcuyDMNc3O1/K38V3rd63+d92/d33tuEXQaLong93O12AQCqqupnS9M00zQlSSJ6vd63q9Tr9Qj0BhF4MK+Q67pvc/4v8GsvwWXOJ6IQL16dL+aT0dgwTHW7nU7GvCC+GOUIdl0XAIAQ6na/NClKVfXJeLxdr37M5nhbnw0icTrh05UTh88Sy7KVSsWyrEwmM5/PJUniOA5CWCwW1+v1/U6H+T/CONtkMhkIBCRJ8ng8oije3NzEYjGO40iS1DSNJMlEIoHzP4JxMJ7nq9XqZrPBe0rvZJomPmy36VardbiCBLbVdR1C6Oz8cSzDMPAM2raNELIsCz59Mk0TZ0rg3zTNMMC27+7usaeuqrcfb5e/Vg3qkyQPZ7OfHfaz+aDn8x90/YGh6eFw9Ajbtr1VtwjCfv/rarX6e2JZ/HfeMMyhLCuKAgDYqqrjgH6/DxxnqSwNw/gD/wakbPY8LdTEDQAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"Score displaying with white background\\\"\\n        title=\\\"Score displaying with white background\\\"\\n        src=\\\"/static/cc4d5fe240197dbd3c878ecdc8ceb629/2f862/reaction3.png\\\"\\n        srcset=\\\"/static/cc4d5fe240197dbd3c878ecdc8ceb629/d23e3/reaction3.png 169w,\\n/static/cc4d5fe240197dbd3c878ecdc8ceb629/2f862/reaction3.png 241w\\\"\\n        sizes=\\\"(max-width: 241px) 100vw, 241px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n  </a>\\n    </span>\"\n    }\n  }), \"\\n\", React.createElement(_components.p, null, \"Since I didn’t know when the square was red I was \", React.createElement(_components.em, null, \"always\"), \" displaying a score, even on misfires. I’d broken the game.\"), \"\\n\", React.createElement(_components.h2, {\n    id: \"trick-2-like-a-polar-bear-in-a-snowstorm\",\n    style: {\n      position: \"relative\"\n    }\n  }, React.createElement(_components.a, {\n    href: \"#trick-2-like-a-polar-bear-in-a-snowstorm\",\n    \"aria-label\": \"trick 2 like a polar bear in a snowstorm permalink\",\n    className: \"anchor before\"\n  }, React.createElement(_components.div, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  })), \"Trick #2: Like a polar bear in a snowstorm\"), \"\\n\", React.createElement(_components.p, null, \"Another popular history-sniffing trick is to hide non-\", React.createElement(\"code\", {\n    className: \"language-css\"\n  }, \":visited\"), \" links by making them appear the same color as the background. \", React.createElement(_components.a, {\n    href: \"http://www.ieee-security.org/TC/SP2011/PAPERS/2011/paper010.pdf\"\n  }, \"This paper\"), \" shows some clever examples, as does \", React.createElement(_components.a, {\n    href: \"http://lcamtuf.blogspot.ca/2013/05/some-harmless-old-fashioned-fun-with-css.html\"\n  }, \"this game\"), \". By simply flipping this technique we can hide score text over the white non-\", React.createElement(\"code\", {\n    className: \"language-css\"\n  }, \":visited\"), \" links. For extra fanciness, we add a red text layer to indicate failure.\"), \"\\n\", React.createElement(Figure, {\n    caption: \"White and red text are appropriately hidden on their respective backgrounds\"\n  }, React.createElement(_components.div, {\n    dangerouslySetInnerHTML: {\n      __html: \"<span\\n      class=\\\"gatsby-resp-image-wrapper\\\"\\n      style=\\\"position: relative; display: block; margin-left: auto; margin-right: auto; max-width: 675px; \\\"\\n    >\\n      <a\\n    class=\\\"gatsby-resp-image-link\\\"\\n    href=\\\"/static/e1da90272d4c56c4b3d5704a9f1e1eed/72aae/reaction4.png\\\"\\n    style=\\\"display: block\\\"\\n    target=\\\"_blank\\\"\\n    rel=\\\"noopener\\\"\\n  >\\n    <span\\n    class=\\\"gatsby-resp-image-background-image\\\"\\n    style=\\\"padding-bottom: 24.85207100591716%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsTAAALEwEAmpwYAAABAElEQVQY002P3UoCQQBGv2UGxjH/LiK8EioIRHqJyCvxcXTxEfx5mXoWIQW78UKtFGZjZneH3eYL7SY4t4fDgahUOkI8S9mOIl2vf+33JM1iYQCnlK0oC5jJJJBllh2TxG029vXFvm9sngNCtIDHKLoClNafux1JN5uVAKUMUhJwcVxe5NR7JgmXSyaGJAA89HpPw+F9t1utVnfbrSftdFoAYTD46fcJZKPRkXTGpFlGMvwRApQQ10q1a7WWlHWtP/6Xm83QaJzL43FBFlmWOss0pbV0jmWJhpR3wG0UdYAbrQ8XOZnPLeClzKX0wHccn5+9N4eDX63z1Vu+Xuen0y9hEK1kckFA7gAAAABJRU5ErkJggg=='); background-size: cover; display: block;\\\"\\n  ></span>\\n  <img\\n        class=\\\"gatsby-resp-image-image\\\"\\n        alt=\\\"Text blending in with same-colored backgrounds\\\"\\n        title=\\\"Text blending in with same-colored backgrounds\\\"\\n        src=\\\"/static/e1da90272d4c56c4b3d5704a9f1e1eed/23296/reaction4.png\\\"\\n        srcset=\\\"/static/e1da90272d4c56c4b3d5704a9f1e1eed/d23e3/reaction4.png 169w,\\n/static/e1da90272d4c56c4b3d5704a9f1e1eed/2b41d/reaction4.png 338w,\\n/static/e1da90272d4c56c4b3d5704a9f1e1eed/23296/reaction4.png 675w,\\n/static/e1da90272d4c56c4b3d5704a9f1e1eed/72aae/reaction4.png 964w\\\"\\n        sizes=\\\"(max-width: 675px) 100vw, 675px\\\"\\n        style=\\\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\\\"\\n        loading=\\\"lazy\\\"\\n        decoding=\\\"async\\\"\\n      />\\n  </a>\\n    </span>\"\n    }\n  })), \"\\n\", React.createElement(_components.p, null, \"With just the first two tricks we have a \", React.createElement(_components.a, {\n    href: \"/visited-vectors/reaction/linear.html\"\n  }, \"functioning game\"), \". Probing one link at a time covers ~60 links per minute and provides solid user insight. Tricks #3 and #4 improve our search algorithm,[^2] increasing read-speed by ~10x.\"), \"\\n\", React.createElement(_components.h2, {\n    id: \"trick-3-css-decoders\",\n    style: {\n      position: \"relative\"\n    }\n  }, React.createElement(_components.a, {\n    href: \"#trick-3-css-decoders\",\n    \"aria-label\": \"trick 3 css decoders permalink\",\n    className: \"anchor before\"\n  }, React.createElement(_components.div, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  })), \"Trick #3: CSS decoders\"), \"\\n\", React.createElement(_components.p, null, React.createElement(_components.a, {\n    href: \"http://lcamtuf.coredump.cx/css_calc/\"\n  }, \"This paper\"), \" builds an n-input OR gate in CSS using alpha-blending rounding errors. I’ve embedded my own cross-browser version below; click Result to see it in action:\"), \"\\n\", React.createElement(\"p\", {\n    className: \"codepen\",\n    \"data-height\": \"265\",\n    \"data-theme-id\": \"5323\",\n    \"data-default-tab\": \"css,result\",\n    \"data-user\": \"rileyjshaw\",\n    \"data-slug-hash\": \"CjiKf\",\n    \"data-pen-title\": \"n-input OR gate in CSS\",\n    style: {\n      height: 265,\n      boxSizing: 'border-box',\n      display: 'flex',\n      alignItems: 'center',\n      justifyContent: 'center',\n      border: '2px solid',\n      margin: '1em 0',\n      padding: '1em'\n    }\n  }, React.createElement(\"span\", null, React.createElement(_components.p, null, \"See the Pen \", React.createElement(\"a\", {\n    href: \"https://codepen.io/rileyjshaw/pen/CjiKf\"\n  }, \"n-input OR gate in CSS\"), \"\\nby Riley Shaw (\", React.createElement(\"a\", {\n    href: \"https://codepen.io/rileyjshaw\"\n  }, \"@rileyjshaw\"), \")\\non \", React.createElement(\"a\", {\n    href: \"https://codepen.io\"\n  }, \"CodePen\"), \".\"))), \"\\n\", React.createElement(\"script\", {\n    async: true,\n    src: \"https://static.codepen.io/assets/embed/ei.js\"\n  }), \"\\n\", React.createElement(_components.p, null, \"An OR gate is on if any of its inputs are on. We can use this to probe n links[^3] at once by stacking them together. Now if a user sees red and hits the spacebar we know that one of the links in the group has been visited.\"), \"\\n\", React.createElement(_components.h2, {\n    id: \"trick-4-slow-recursion\",\n    style: {\n      position: \"relative\"\n    }\n  }, React.createElement(_components.a, {\n    href: \"#trick-4-slow-recursion\",\n    \"aria-label\": \"trick 4 slow recursion permalink\",\n    className: \"anchor before\"\n  }, React.createElement(_components.div, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  })), \"Trick #4: Slow recursion\"), \"\\n\", React.createElement(_components.p, null, \"This trick figures out \", React.createElement(_components.em, null, \"which\"), \" of a group’s links have been visited. We can divide each group into a binary tree for searching but can’t rely on simple conditional search algorithms[^4] since we’re rate-limited by the user’s reaction time.[^5] This means that we must maintain state in our own stack.\"), \"\\n\", React.createElement(_components.p, null, \"If you’re curious about specifics, \", React.createElement(_components.a, {\n    href: \"https://github.com/rileyjshaw/visited-vectors/\"\n  }, \"the whole project is on GitHub\"), \". Since the code’s cluttered with game logic I’ve written a \", React.createElement(_components.a, {\n    href: \"https://gist.github.com/rileyjshaw/02c5a8135dd3b1368918\"\n  }, \"stripped-down version of Trick #4\"), \".\"), \"\\n\", React.createElement(_components.h2, {\n    id: \"trick-5-automation\",\n    style: {\n      position: \"relative\"\n    }\n  }, React.createElement(_components.a, {\n    href: \"#trick-5-automation\",\n    \"aria-label\": \"trick 5 automation permalink\",\n    className: \"anchor before\"\n  }, React.createElement(_components.div, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  })), \"Trick #5: Automation\"), \"\\n\", React.createElement(_components.p, null, \"Despite the gains achieved in Tricks #3 and #4, relying on user input will never be as fast as the old \", React.createElement(\"code\", {\n    className: \"language-javascript\"\n  }, \"getComputedStyle\"), \" method.[^6] Since we can no-longer automate color tests, is it possible to avoid looking at color altogether?[^7] Testing 16 links requires alpha-blending 4,096 elements at each step.[^8] This is a non-trivial operation; can we infer what the browser is drawing by testing render and redraw times?\"), \"\\n\", React.createElement(_components.p, null, \"This is a \", React.createElement(_components.a, {\n    href: \"http://carlos.bueno.org/2011/10/timing.html\"\n  }, \"timing attack\"), \" and I’m not the first to apply it to this context. \", React.createElement(_components.a, {\n    href: \"http://www.contextis.com/documents/2/Browser_Timing_Attacks.pdf\"\n  }, \"Pixel Perfect Timing Attacks with HTML5\"), \" is a \", React.createElement(_components.em, null, \"fantastic\"), \" white paper by Context Information Security on the subject. They were able to successfully implement timing attacks using CSS’s \", React.createElement(\"code\", {\n    className: \"language-css\"\n  }, \"text-shadow\"), \" property and SVG filters.[^9] So, there’s the answer. Now go read that paper.\"), \"\\n\", React.createElement(_components.h2, {\n    id: \"conclusion\",\n    style: {\n      position: \"relative\"\n    }\n  }, React.createElement(_components.a, {\n    href: \"#conclusion\",\n    \"aria-label\": \"conclusion permalink\",\n    className: \"anchor before\"\n  }, React.createElement(_components.div, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  })), \"Conclusion\"), \"\\n\", React.createElement(_components.p, null, \"I won’t be taking over the world with this project[^10] but it demonstrates some interesting vectors. More security patches will be released, more creative hacks will arise; all it takes is a toehold and some creativity. Powerful new features make room for novel vulnerabilities. And so it goes.\"), \"\\n\", React.createElement(_components.p, null, \"Regarding browsing history, reaction games probably aren’t your \", React.createElement(_components.a, {\n    href: \"http://en.wikipedia.org/wiki/Global_surveillance_disclosures_(2013%E2%80%93present)\"\n  }, \"biggest concern\"), \" anyway. I’ll just \", React.createElement(_components.a, {\n    href: \"https://www.eff.org/\"\n  }, \"leave\"), \" \", React.createElement(_components.a, {\n    href: \"https://www.torproject.org/\"\n  }, \"these\"), \" \", React.createElement(_components.a, {\n    href: \"https://tails.boum.org/\"\n  }, \"here\"), \".\"), \"\\n\", React.createElement(_components.p, null, \"And if you made it this far, just \", React.createElement(_components.a, {\n    href: \"/visited-vectors/reaction/\"\n  }, \"play the damn game already\"), \"!\"), \"\\n\", React.createElement(_components.h2, {\n    id: \"references\",\n    style: {\n      position: \"relative\"\n    }\n  }, React.createElement(_components.a, {\n    href: \"#references\",\n    \"aria-label\": \"references permalink\",\n    className: \"anchor before\"\n  }, React.createElement(_components.div, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  })), \"References\"), \"\\n\", React.createElement(_components.ul, null, \"\\n\", React.createElement(_components.li, null, React.createElement(_components.a, {\n    href: \"https://hacks.mozilla.org/2010/03/privacy-related-changes-coming-to-css-vistited/\"\n  }, \"Mozilla: privacy-related changes coming to CSS :visited\")), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.a, {\n    href: \"http://tinsnail.neocities.org/\"\n  }, \"Who Am I\")), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.a, {\n    href: \"http://www.ieee-security.org/TC/SP2011/PAPERS/2011/paper010.pdf\"\n  }, \"I still know what you visited last summer\")), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.a, {\n    href: \"http://lcamtuf.blogspot.ca/2013/05/some-harmless-old-fashioned-fun-with-css.html\"\n  }, \"Defend your spaceship!\")), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.a, {\n    href: \"http://saizai.livejournal.com/960791.html\"\n  }, \"getComputedStyle benchmark\")), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.a, {\n    href: \"http://www.contextis.com/documents/2/Browser_Timing_Attacks.pdf\"\n  }, \"Pixel perfect timing attacks with HTML5\")), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.a, {\n    href: \"http://seclists.org/fulldisclosure/2011/Dec/65\"\n  }, \"Fast and somewhat reliable cache timing\")), \"\\n\", React.createElement(_components.li, null, React.createElement(_components.a, {\n    href: \"http://arstechnica.com/security/2012/12/online-marketer-tapped-browser-flaw-to-see-if-visitors-were-pregnant/\"\n  }, \"History-sniffing in the news (2012)\")), \"\\n\"), \"\\n\", React.createElement(_components.h2, {\n    id: \"footnotes\",\n    style: {\n      position: \"relative\"\n    }\n  }, React.createElement(_components.a, {\n    href: \"#footnotes\",\n    \"aria-label\": \"footnotes permalink\",\n    className: \"anchor before\"\n  }, React.createElement(_components.div, {\n    dangerouslySetInnerHTML: {\n      __html: \"<svg aria-hidden=\\\"true\\\" focusable=\\\"false\\\" height=\\\"16\\\" version=\\\"1.1\\\" viewBox=\\\"0 0 16 16\\\" width=\\\"16\\\"><path fill-rule=\\\"evenodd\\\" d=\\\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\\\"></path></svg>\"\n    }\n  })), \"Footnotes\"), \"\\n\", React.createElement(_components.p, null, \"[^1]: A noble effort, but it’s difficult to plug all the \", React.createElement(_components.a, {\n    href: \"http://arstechnica.com/security/2014/06/theyre-ba-ack-browser-sniffing-ghosts-return-to-haunt-chrome-ie-firefox/\"\n  }, \"holes\"), \".\\n[^2]: True under the assumption that the dataset is sparsely populated with \", React.createElement(\"code\", {\n    className: \"language-css\"\n  }, \":visited\"), \" links. If there is a high percentage of \", React.createElement(\"code\", {\n    className: \"language-css\"\n  }, \":visited\"), \" links in the set you’re actually better off with the linear algorithm. Good news: counting on a sparse dataset is a very safe bet.\\n[^3]: I settled on n = 16 unique links per stack. Adding more links gives a performance hit, as it’s not easy for the browser to composite that many layers (each unique link requires 256 elements). 16 seems to be a sweet-spot.\\n[^4]: We can win the same O(logn) complexity with a small optimization: if spacebar is hit on level n and then \", React.createElement(_components.em, null, \"not\"), \" on the left branch of level n + 1, we can immediately skip to level n + 2 since we know that our result is on the right side. This works because we only need to check for existence.\\n[^5]: Average human reaction time is just over 250ms, so we can safely budget 1s per frame-change.\\n[^6]:\\n\", React.createElement(\"code\", {\n    className: \"language-javascript\"\n  }, \"getComputedStyle\"), \" could process \", React.createElement(_components.a, {\n    href: \"http://saizai.livejournal.com/960791.html\"\n  }, \"200k-3.4M URLs/min\"), \". Our test is lucky to get 800 URLs/min.\"), \"\\n\", React.createElement(_components.p, null, \"[^7]: Some history-sniffing attacks focus on entirely different vectors; a common example is to \", React.createElement(_components.a, {\n    href: \"http://seclists.org/fulldisclosure/2011/Dec/65\"\n  }, \"request external resources and time the response\"), \", probabilistically determining whether the result was cached. All current approaches that I’ve found (including the ones discussed above) are timing attacks.\\n[^8]: I created a quick demo \", React.createElement(_components.a, {\n    href: \"https://gist.github.com/rileyjshaw/abc13bd2d456669c7d5c\"\n  }, \"here\"), \" to inspect painting times in DevTools.\\n[^9]: The coolest part of this paper is the second half; they implement OCR for cross-origin iframes using SVG filters. If you enjoyed my article at all (I assume you did since you made it this far) I \", React.createElement(_components.em, null, \"highly\"), \" recommend giving \", React.createElement(_components.a, {\n    href: \"http://www.contextis.com/documents/2/Browser_Timing_Attacks.pdf\"\n  }, \"Pixel perfect timing attacks with HTML5\"), \" a read. It’s at least 2 orders of magnitude cooler than my article.\\n[^10]: …but just wait until you see the next one.\"));\n}\nfunction MDXContent(props = {}) {\n  const {wrapper: MDXLayout} = Object.assign({}, _provideComponents(), props.components);\n  return MDXLayout ? React.createElement(MDXLayout, props, React.createElement(_createMdxContent, props)) : _createMdxContent(props);\n}\nexport default MDXContent;\n","import GATSBY_COMPILED_MDX from \"/Users/lamp/code/rileyjshaw/src/data/markdown/posts/published/2014-11-12-stealing-history-with-CSS-binary-trees.mdx\";\nimport SEO from '../components/seo';\nimport './post.css';\nimport {Link, graphql} from 'gatsby';\nimport React from 'react';\nexport function Head({data, ...props}) {\n  return React.createElement(SEO, Object.assign({}, props, {\n    title: data.mdx.fields.title\n  }));\n}\nfunction Template({data, children}) {\n  const {mdx} = data;\n  const {fields} = mdx;\n  return React.createElement(React.Fragment, null, React.createElement(\"header\", {\n    className: \"top-nav\",\n    role: \"banner\"\n  }, React.createElement(\"nav\", {\n    role: \"navigation\"\n  }, React.createElement(\"h1\", null, React.createElement(Link, {\n    to: \"/\"\n  }, \"Riley Shaw\")), ' ', \" / \", React.createElement(Link, {\n    to: \"/blog\"\n  }, \"Blog\"), \" / \", fields.title)), React.createElement(\"main\", null, React.createElement(\"article\", {\n    className: \"blog-post-content\",\n    role: \"article\"\n  }, React.createElement(\"header\", null, React.createElement(\"h1\", null, fields.title), React.createElement(\"div\", {\n    className: \"subheading\"\n  }, React.createElement(\"time\", null, \"Posted \", fields.date))), React.createElement(\"div\", {\n    className: \"blog-post-markdown\"\n  }, children))));\n}\nexport default function GatsbyMDXWrapper(props) {\n  return React.createElement(Template, props, React.createElement(GATSBY_COMPILED_MDX, props));\n}\nexport const pageQuery = graphql`\n\tquery PostTemplate($id: String!) {\n\t\tmdx(id: {eq: $id}) {\n\t\t\tfields {\n\t\t\t\tdate(formatString: \"MMMM DD, YYYY\")\n\t\t\t\tslug\n\t\t\t\ttitle\n\t\t\t}\n\t\t}\n\t}\n`;\n","import './blog-banner.css';\nimport React from 'react';\n\nconst bannerTypes = {\n\tedit: {\n\t\ttitle: 'Edit',\n\t},\n\tnote: {\n\t\ttitle: 'Note',\n\t},\n\tupdate: {\n\t\ttitle: 'Update',\n\t},\n};\n\nexport default ({children, date, type = 'update'}) => (\n\t<div className={`blog-banner blog-banner-${type}`}>\n\t\t<div className=\"blog-banner-title\">\n\t\t\t{`${bannerTypes[type].title}${date ? ` ${date}` : ''}:`}\n\t\t</div>\n\t\t<div className=\"blog-banner-content\">{children}</div>\n\t</div>\n);\n\nexport const BlogBannerGroup = ({children}) => (\n\t<div className=\"blog-banner-group\">{children}</div>\n);\n","import React from 'react';\n\nexport default ({caption, children, width}) => (\n\t<figure className=\"blog-figure\">\n\t\t{width ? <div width={width}>{children}</div> : children}\n\t\t<figcaption>{caption}</figcaption>\n\t</figure>\n);\n","/**\n * SEO component that queries for data with\n *  Gatsby's useStaticQuery React hook\n *\n * See: https://www.gatsbyjs.org/docs/use-static-query/\n */\nimport {useStaticQuery, graphql} from 'gatsby';\nimport React from 'react';\n\nfunction SEO({description = '', title: pageTitle, children}) {\n\tconst {site} = useStaticQuery(\n\t\tgraphql`\n\t\t\tquery {\n\t\t\t\tsite {\n\t\t\t\t\tsiteMetadata {\n\t\t\t\t\t\ttitle\n\t\t\t\t\t\ttitlePostfix\n\t\t\t\t\t\tdescription\n\t\t\t\t\t\tauthor\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t`\n\t);\n\n\tconst title = `${pageTitle || site.siteMetadata.title} · ${\n\t\tsite.siteMetadata.titlePostfix\n\t}`;\n\tconst metaTitle = `${pageTitle ? `${pageTitle} · ` : ''}${\n\t\tsite.siteMetadata.title\n\t}`;\n\tconst metaDescription = description || site.siteMetadata.description;\n\n\treturn (\n\t\t<>\n\t\t\t<title>{title}</title>\n\t\t\t<meta name=\"description\" content={metaDescription} />\n\t\t\t<meta name=\"og:title\" content={metaTitle} />\n\t\t\t<meta name=\"og:description\" content={metaDescription} />\n\t\t\t<meta name=\"og:type\" content=\"website\" />\n\t\t\t<meta name=\"twitter:title\" content={metaTitle} />\n\t\t\t<meta name=\"twitter:description\" content={metaDescription} />\n\t\t\t<meta name=\"twitter:card\" content=\"summary\" />\n\t\t\t<meta name=\"twitter:creator\" content={site.siteMetadata.author} />\n\t\t\t{/* TODO: Update properties to include:\n\n\t\t<meta name=\"image\" content={seo.image} />\n\t\t<meta name=\"twitter:url\" content={seo.url} />\n\t\t<meta name=\"twitter:image\" content={seo.image} />\n\n\t\t*/}\n\t\t\t{children}\n\t\t</>\n\t);\n}\n\nexport default SEO;\n"],"names":["_createMdxContent","props","_components","Object","assign","p","a","h2","div","em","ul","li","_provideComponents","components","React","BlogBanner","type","date","className","href","id","style","position","dangerouslySetInnerHTML","__html","Figure","caption","height","boxSizing","display","alignItems","justifyContent","border","margin","padding","async","src","MDXLayout","wrapper","Head","data","SEO","title","mdx","fields","Template","children","role","Link","to","GatsbyMDXWrapper","GATSBY_COMPILED_MDX","bannerTypes","edit","note","update","BlogBannerGroup","width","description","pageTitle","site","useStaticQuery","siteMetadata","titlePostfix","metaTitle","metaDescription","name","content","author"],"sourceRoot":""}