{"componentChunkName":"component---src-templates-post-js","path":"/blog/stealing-history-with-CSS-binary-trees","result":{"data":{"mdx":{"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsxRuntime classic */\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"layout\": \"post\",\n  \"title\": \"Stealing history with CSS binary trees\",\n  \"tags\": [\"security\", \"css\", \"build\"]\n};\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"UPDATE 2015-01-21\"), \": \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"Since writing this post, Chrome and FF have changed their alpha-blending functions. Demos likely won\\u2019t work anymore. This is good news!!\")), mdx(\"p\", null, \"History-sniffing attacks let front-end code peek at other sites you\\u2019ve visited. They can be used to target ads, steal information, or discern your identity. Creepy.\"), mdx(\"p\", null, \"Historically, one of the most popular history-sniffing techniques was to style \", mdx(\"code\", {\n    className: \"language-css\"\n  }, \":visited\"), \" links using CSS and check their color with JavaScript. Major browsers started implementing \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://hacks.mozilla.org/2010/03/privacy-related-changes-coming-to-css-vistited/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"privacy changes\"), \" to address this attack in 2010.\", mdx(\"sup\", _extends({\n    parentName: \"p\"\n  }, {\n    \"id\": \"fnref-1\"\n  }), mdx(\"a\", _extends({\n    parentName: \"sup\"\n  }, {\n    \"href\": \"#fn-1\",\n    \"className\": \"footnote-ref\"\n  }), \"1\")), \" As a result, JavaScript\\u2019s \", mdx(\"code\", {\n    className: \"language-javascript\"\n  }, \"getComputedStyle\"), \" now returns unvisited styles for visited sites.\"), mdx(\"p\", null, \"Even with these limitations there are a number of ways to scrape a user\\u2019s history. The remainder of this article describes a combination of tricks used to do so. The outcome is a proof-of-concept \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"/visited-vectors/reaction/\"\n  }), \"history-sniffing game\"), \".\"), mdx(\"h2\", {\n    \"id\": \"trick-1-clicking-colors\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"href\": \"#trick-1-clicking-colors\",\n    \"aria-label\": \"trick 1 clicking colors permalink\",\n    \"className\": \"anchor before\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"Trick #1: Clicking colors\"), mdx(\"p\", null, \"Though \", mdx(\"code\", {\n    className: \"language-javascript\"\n  }, \"getComputedStyle\"), \" is a dead-end, sniffers can trick \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"users\"), \" into telling a script which links they\\u2019ve visited. \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://tinsnail.neocities.org/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"This demo\"), \" is the clearest implementation that I\\u2019ve seen; the site shows a grid of styled links and asks you to click the red ones.\"), mdx(\"p\", null, \"I saw the demo above while working on an unrelated game. The game asked players to hit the spacebar when a box turned red.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"241px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/b5970e182bf26a4d74b659409d1f1283/2f862/reaction1.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"254.43786982248523%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAzCAIAAAAYQr/UAAAACXBIWXMAAAsSAAALEgHS3X78AAADIklEQVRIx+1WS0/iUBTurzFuXPsDXLpybfwR7twYNyZGNyYmmrjQxbByY5TMIMlMJhqRQUqHCoQWEBgo0AdtbQu0FGiZD2sIMpjxMZOZhSdpc+6957vnce+55xD9fl/XNSpGdbvdGzrOC0JdruuGTpJky7KwqiqyrjeSiYQgiBj2XTcWi7VMEyyBz7IsURQdx7mhaUEUREk0zRYVI6V6HauKLBlGk2WY29uCJxwOX3lLA/Aoua47yowOhzQUJrDT8vIyTdPn5+c7OzuYOjg46HQ6gcAnv99fq9VWV1ez2ezFxUWlUtnc3EylUpDc2NjgeZ7QNG1mZub4+Hh/f39xcVEQhNnZ2Wg0urW1tbe3h63X19fhFHhMzs/Pn5ycHB4eTk1NJZNJAnHCHrquq6paLBabzSaG4FutFoYwRNN1hAM6XNcpFAq2bRuGIUkS9h33GXspigIGEsA0Go07Ve12e/V6XdeN0Sg8BMwbQxT/culHKBSCz1+/fC6VOZZlfB98snx3HbmWZHUskBM0F/L5dtvWNc00Tc9Ix3F5vqZN1PxqmgAeNWzsnH8PfpPmF4Dd1xJO522akV+4uuwLKZPJxONxIhKJ4GxxmM1nE65du91mGIZAlgyv1zPJOzMkGYHkeB2Y47h38Dv4HfzHwW/KZ9Q+cCgO7WcTShyU4fEavGG5XC7zQgJy8Ib9u0f/PwOP1sSJ9fEvaPaUoH1BWzM4UnPQ3xVLpbGeYAIYy71eDwzDMlehK1VRKmWu0TCy970flsbwT5rd63afcnUc7MmVy+VEIoFWKBgMojOTZblarWL+8vIS9Y2iqHQ6PWo/MWyC8N/d3Z2bm8ONn56eRhFcW1tbWVnBdktLSyijCwsL29vbnv2PwF5WoQP1+dB1yV62BO8J3eDR0RFCeHp6ig70keb7IDn4e8ofHP4lNt5qpwufOuBxEJ5mF6213//RtEyKjCZSab5WJanvHds+CwTyuTyE4PBZ8ExR1RgZ5bhKja9eR0lsMjC7kL8Nh785Tq/KcaIEq+U0y8KRVCJRKpUhYHds+oY2LSvDsoIgoTNOJlMw7SfBQ1mBif79rQAAAABJRU5ErkJggg==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Interface for a simple reaction game\",\n    \"title\": \"Interface for a simple reaction game\",\n    \"src\": \"/static/b5970e182bf26a4d74b659409d1f1283/2f862/reaction1.png\",\n    \"srcSet\": [\"/static/b5970e182bf26a4d74b659409d1f1283/d23e3/reaction1.png 169w\", \"/static/b5970e182bf26a4d74b659409d1f1283/2f862/reaction1.png 241w\"],\n    \"sizes\": \"(max-width: 241px) 100vw, 241px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, mdx(\"em\", {\n    parentName: \"p\"\n  }, \"\\u201CHey\\u201D\"), \", I thought to myself, \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"\\u201Cthis game could be so much more sneaky!\\u201D\")), mdx(\"p\", null, \"I swapped the box out for a stack of links and styled \", mdx(\"code\", {\n    className: \"language-css\"\n  }, \":visited\"), \" to \", mdx(\"code\", {\n    className: \"language-css\"\n  }, \"background-color:red\"), \". It was totally evil and awesome and ready to go!\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"241px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/06e27a316663bc24564927d635022c84/2f862/reaction2.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"177.5147928994083%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAkCAIAAAAGkY33AAAACXBIWXMAAAsTAAALEwEAmpwYAAACQElEQVRIx91TTW8SURQ909BNF03a9FdIWLJqYlyaEHXJhr/h2gXxH1ASE7sScQUhtrIwdQEUxBmtgQLF8lnAhq9p+SzJMG/wdqZMsDYytMZFX05u7rvzzjv3nfcG/s3NhNksWCxfF8E3iyVqsYBfXZ0AjOMoGoSixiGAL+vrlI2XlohvEDIpcVyP48Cvrd1OeUDK94PMyDxAVsFUyDOVBZQV48paqQx8BEJAHDgDjoEDWgPkgdSUdgNZ6+oN8AB4BTwDnqjxKfAIeAw8BMTp0a6TtVIUeAu8Bp4DL4CXwHcgprbzTiXMP/Noxh72x+HnuK2t0A3XPb+fL2wxsrCxQT8nW16emEwGoahxYDJhf2WFtpGmr9cIxqp491J5ezu7tZVxuxfFoduNyR0GlPF4clvcTfnfk5XfB2PsfykPh0Ox1ZKkMSWd8/NcLj+fTB1KkkRJvlD4sPu+3x8W84V+r3ucK1CRmh+TyUbalmWZMUV34G/K2mdRFOPxOOXhcLhWq41Go2KxSHWe509Pf1ar1Wg0egOZdCgGg0Gz2dxsNq1Wq9/vDwQCNpuNpna7vVKpOJ1Oh8OhK11XLpVKLper1WqFQiGaRiIRr9fb6XR8Ph+1QPoej0e/yCsyZaSszpVZ82YTckuv6PkleXRxEfscIz7PC+l0RjvFp729k2ote5RJJg8Hg8F+LEoSuzs7jWY7n8sdZX9ckRmT640GJelUqlw+0fZOJhKttlirVujalIlSb9SpLghCt9c/E8V2u03TXxVtAMQ+BxSBAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Score displaying with red background\",\n    \"title\": \"Score displaying with red background\",\n    \"src\": \"/static/06e27a316663bc24564927d635022c84/2f862/reaction2.png\",\n    \"srcSet\": [\"/static/06e27a316663bc24564927d635022c84/d23e3/reaction2.png 169w\", \"/static/06e27a316663bc24564927d635022c84/2f862/reaction2.png 241w\"],\n    \"sizes\": \"(max-width: 241px) 100vw, 241px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"\\u2026almost.\"), mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"241px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/cc4d5fe240197dbd3c878ecdc8ceb629/2f862/reaction3.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"177.5147928994083%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAkCAIAAAAGkY33AAAACXBIWXMAAAsTAAALEwEAmpwYAAACMUlEQVRIx91VXY/hYBT2e7h2KW4lYl268TdcuxD/wI249HVFZGdWQmYTn0UtgjK1LWa0O0HVaDESqt0z3klDdmbVzO7NnIvmnNP36XPe877nqS4ejzebzWq1+uMSq9VqxWJRh+O4oij7/V7RbLIsw3O9XusqlQp4u91ur9kkSQKIKIrvZ16tVp8EDA40TzqY2h41cwEzWqSJGaWGw2E6nc5kMqVSaT6f93q9er0Oa2iaJggCrXkFjKoKBoN6vd7v99vtdpvN9uVgZrPZYrGYTCae59UyT8AoBZcuHA4HAgGXy+V2u71eb6PRwDAslUpFo1EAnN/zZrNR26PuSGu30Qq14WrPP+cNuwwMGvJ+cKFQAG+73UqaDdoOeEEQnplJkuxebu12W6d8wHRvjY4m8IeY/z1YPrW3DvI/MMPfgOe47XYHzuLxkaLo82CoEG4LOHS//+3663K5HtD9pSj8pPrH03q+7MMwy2oH/saMXoNElctl8HO5HMuyoCeDwQDyMDwPD78YhgGRegWMRCeZTBoMhul0ajQa4debSCSsViuEDodjNBp5PB6n03ksySfMoLs+n4/juGw2C2E+n49EIovFIhaLQQnAHwqF1IN8ASO5OsTyn4qPnGMZVP1n8ObpCSthgMfxaqfTRbv4fnNzz7DkbbfVasPoFrAiUFxfXU2mM5qibsneCxi0cTyZgNMhiLu7e/TtVrPJzXiWGcGxyYo8nowhD/MriMs5z89mMwh/A+qs8lN/jfWbAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Score displaying with white background\",\n    \"title\": \"Score displaying with white background\",\n    \"src\": \"/static/cc4d5fe240197dbd3c878ecdc8ceb629/2f862/reaction3.png\",\n    \"srcSet\": [\"/static/cc4d5fe240197dbd3c878ecdc8ceb629/d23e3/reaction3.png 169w\", \"/static/cc4d5fe240197dbd3c878ecdc8ceb629/2f862/reaction3.png 241w\"],\n    \"sizes\": \"(max-width: 241px) 100vw, 241px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \")), mdx(\"p\", null, \"Since I didn\\u2019t know when the square was red I was \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"always\"), \" displaying a score, even on misfires. I\\u2019d broken the game.\"), mdx(\"h2\", {\n    \"id\": \"trick-2-like-a-polar-bear-in-a-snowstorm\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"href\": \"#trick-2-like-a-polar-bear-in-a-snowstorm\",\n    \"aria-label\": \"trick 2 like a polar bear in a snowstorm permalink\",\n    \"className\": \"anchor before\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"Trick #2: Like a polar bear in a snowstorm\"), mdx(\"p\", null, \"Another popular history-sniffing trick is to hide non-\", mdx(\"code\", {\n    className: \"language-css\"\n  }, \":visited\"), \" links by making them appear the same color as the background. \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://www.ieee-security.org/TC/SP2011/PAPERS/2011/paper010.pdf\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"This paper\"), \" shows some clever examples, as does \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://lcamtuf.blogspot.ca/2013/05/some-harmless-old-fashioned-fun-with-css.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"this game\"), \". By simply flipping this technique we can hide score text over the white non-\", mdx(\"code\", {\n    className: \"language-css\"\n  }, \":visited\"), \" links. For extra fanciness, we add a red text layer to indicate failure.\"), mdx(Figure, {\n    caption: \"White and red text are appropriately hidden on their respective backgrounds\",\n    mdxType: \"Figure\"\n  }, mdx(\"p\", null, mdx(\"span\", _extends({\n    parentName: \"p\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"675px\"\n    }\n  }), \"\\n      \", mdx(\"a\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-link\",\n    \"href\": \"/static/e1da90272d4c56c4b3d5704a9f1e1eed/72aae/reaction4.png\",\n    \"style\": {\n      \"display\": \"block\"\n    },\n    \"target\": \"_blank\",\n    \"rel\": \"noopener\"\n  }), \"\\n    \", mdx(\"span\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"24.85207100591716%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAFCAIAAADKYVtkAAAACXBIWXMAAAsSAAALEgHS3X78AAAA/ElEQVQY002PsU7DQBBEJz5bviLORTIICVEQikiIIh8B6ZJvck75o3wMRG5SusAJvuTOPsvGywYaVtPsat6MFkLKRyGWUXQLqDQ9H49EVG23BnBxbKW0AK987Oq6NMblud3t7OFgvQeEmAIvQSCBRClTluxzWn8DFIYURcQpWvdEfdPUbUvG0Mc7XS5sA8/zYvG6Xs/m86lSn0XhGc6ynuHVali+saXOMo50xjRNw8zwp2FALMSNlHfjcRIEqVLV/2alaJJcmzcbbu4YdY6Yt5bqmvoeEyGegNlo9ADcK/X1+7PR2gFtGPooaoGz1lzVeV8VRbvfe1ae+9PpB+R4rjT9xeQdAAAAAElFTkSuQmCC')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"a\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"alt\": \"Text blending in with same-colored backgrounds\",\n    \"title\": \"Text blending in with same-colored backgrounds\",\n    \"src\": \"/static/e1da90272d4c56c4b3d5704a9f1e1eed/23296/reaction4.png\",\n    \"srcSet\": [\"/static/e1da90272d4c56c4b3d5704a9f1e1eed/d23e3/reaction4.png 169w\", \"/static/e1da90272d4c56c4b3d5704a9f1e1eed/2b41d/reaction4.png 338w\", \"/static/e1da90272d4c56c4b3d5704a9f1e1eed/23296/reaction4.png 675w\", \"/static/e1da90272d4c56c4b3d5704a9f1e1eed/72aae/reaction4.png 964w\"],\n    \"sizes\": \"(max-width: 675px) 100vw, 675px\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    },\n    \"loading\": \"lazy\"\n  })), \"\\n  \"), \"\\n    \"))), mdx(\"p\", null, \"With just the first two tricks we have a \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"/visited-vectors/reaction/linear.html\"\n  }), \"functioning game\"), \". Probing one link at a time covers ~60 links per minute and provides solid user insight. Tricks #3 and #4 improve our search algorithm,\", mdx(\"sup\", _extends({\n    parentName: \"p\"\n  }, {\n    \"id\": \"fnref-2\"\n  }), mdx(\"a\", _extends({\n    parentName: \"sup\"\n  }, {\n    \"href\": \"#fn-2\",\n    \"className\": \"footnote-ref\"\n  }), \"2\")), \" increasing read-speed by ~10x.\"), mdx(\"h2\", {\n    \"id\": \"trick-3-css-decoders\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"href\": \"#trick-3-css-decoders\",\n    \"aria-label\": \"trick 3 css decoders permalink\",\n    \"className\": \"anchor before\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"Trick #3: CSS decoders\"), mdx(\"p\", null, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://lcamtuf.coredump.cx/css_calc/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"This paper\"), \" builds an n-input OR gate in CSS using alpha-blending rounding errors. I\\u2019ve embedded my own cross-browser version below; click Result to see it in action:\"), mdx(\"p\", {\n    className: \"codepen\",\n    \"data-height\": \"265\",\n    \"data-theme-id\": \"5323\",\n    \"data-default-tab\": \"css,result\",\n    \"data-user\": \"rileyjshaw\",\n    \"data-slug-hash\": \"CjiKf\",\n    style: {\n      \"height\": \"265px\",\n      \"boxSizing\": \"border-box\",\n      \"display\": \"flex\",\n      \"alignItems\": \"center\",\n      \"justifyContent\": \"center\",\n      \"border\": \"2px solid\",\n      \"margin\": \"1em 0\",\n      \"padding\": \"1em\"\n    },\n    \"data-pen-title\": \"n-input OR gate in CSS\"\n  }, mdx(\"span\", null, \"See the Pen \", mdx(\"a\", {\n    href: \"https://codepen.io/rileyjshaw/pen/CjiKf\"\n  }, \"n-input OR gate in CSS\"), \" by Riley Shaw (\", mdx(\"a\", {\n    href: \"https://codepen.io/rileyjshaw\"\n  }, \"@rileyjshaw\"), \") on \", mdx(\"a\", {\n    href: \"https://codepen.io\"\n  }, \"CodePen\"), \".\")), mdx(\"script\", {\n    async: true,\n    src: \"https://static.codepen.io/assets/embed/ei.js\"\n  }), mdx(\"p\", null, \"An OR gate is on if any of its inputs are on. We can use this to probe n links\", mdx(\"sup\", _extends({\n    parentName: \"p\"\n  }, {\n    \"id\": \"fnref-3\"\n  }), mdx(\"a\", _extends({\n    parentName: \"sup\"\n  }, {\n    \"href\": \"#fn-3\",\n    \"className\": \"footnote-ref\"\n  }), \"3\")), \" at once by stacking them together. Now if a user sees red and hits the spacebar we know that one of the links in the group has been visited.\"), mdx(\"h2\", {\n    \"id\": \"trick-4-slow-recursion\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"href\": \"#trick-4-slow-recursion\",\n    \"aria-label\": \"trick 4 slow recursion permalink\",\n    \"className\": \"anchor before\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"Trick #4: Slow recursion\"), mdx(\"p\", null, \"This trick figures out \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"which\"), \" of a group\\u2019s links have been visited. We can divide each group into a binary tree for searching but can\\u2019t rely on simple conditional search algorithms\", mdx(\"sup\", _extends({\n    parentName: \"p\"\n  }, {\n    \"id\": \"fnref-4\"\n  }), mdx(\"a\", _extends({\n    parentName: \"sup\"\n  }, {\n    \"href\": \"#fn-4\",\n    \"className\": \"footnote-ref\"\n  }), \"4\")), \" since we\\u2019re rate-limited by the user\\u2019s reaction time.\", mdx(\"sup\", _extends({\n    parentName: \"p\"\n  }, {\n    \"id\": \"fnref-5\"\n  }), mdx(\"a\", _extends({\n    parentName: \"sup\"\n  }, {\n    \"href\": \"#fn-5\",\n    \"className\": \"footnote-ref\"\n  }), \"5\")), \" This means that we must maintain state in our own stack.\"), mdx(\"p\", null, \"If you\\u2019re curious about specifics, \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/rileyjshaw/visited-vectors/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"the whole project is on GitHub\"), \". Since the code\\u2019s cluttered with game logic I\\u2019ve written a \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://gist.github.com/rileyjshaw/02c5a8135dd3b1368918\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"stripped-down version of Trick #4\"), \".\"), mdx(\"h2\", {\n    \"id\": \"trick-5-automation\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"href\": \"#trick-5-automation\",\n    \"aria-label\": \"trick 5 automation permalink\",\n    \"className\": \"anchor before\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"Trick #5: Automation\"), mdx(\"p\", null, \"Despite the gains achieved in Tricks #3 and #4, relying on user input will never be as fast as the old \", mdx(\"code\", {\n    className: \"language-javascript\"\n  }, \"getComputedStyle\"), \" method.\", mdx(\"sup\", _extends({\n    parentName: \"p\"\n  }, {\n    \"id\": \"fnref-6\"\n  }), mdx(\"a\", _extends({\n    parentName: \"sup\"\n  }, {\n    \"href\": \"#fn-6\",\n    \"className\": \"footnote-ref\"\n  }), \"6\")), \" Since we can no-longer automate color tests, is it possible to avoid looking at color altogether?\", mdx(\"sup\", _extends({\n    parentName: \"p\"\n  }, {\n    \"id\": \"fnref-7\"\n  }), mdx(\"a\", _extends({\n    parentName: \"sup\"\n  }, {\n    \"href\": \"#fn-7\",\n    \"className\": \"footnote-ref\"\n  }), \"7\")), \" Testing 16 links requires alpha-blending 4,096 elements at each step.\", mdx(\"sup\", _extends({\n    parentName: \"p\"\n  }, {\n    \"id\": \"fnref-8\"\n  }), mdx(\"a\", _extends({\n    parentName: \"sup\"\n  }, {\n    \"href\": \"#fn-8\",\n    \"className\": \"footnote-ref\"\n  }), \"8\")), \" This is a non-trivial operation; can we infer what the browser is drawing by testing render and redraw times?\"), mdx(\"p\", null, \"This is a \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://carlos.bueno.org/2011/10/timing.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"timing attack\"), \" and I\\u2019m not the first to apply it to this context. \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://www.contextis.com/documents/2/Browser_Timing_Attacks.pdf\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"Pixel Perfect Timing Attacks with HTML5\"), \" is a \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"fantastic\"), \" white paper by Context Information Security on the subject. They were able to successfully implement timing attacks using CSS\\u2019s \", mdx(\"code\", {\n    className: \"language-css\"\n  }, \"text-shadow\"), \" property and SVG filters.\", mdx(\"sup\", _extends({\n    parentName: \"p\"\n  }, {\n    \"id\": \"fnref-9\"\n  }), mdx(\"a\", _extends({\n    parentName: \"sup\"\n  }, {\n    \"href\": \"#fn-9\",\n    \"className\": \"footnote-ref\"\n  }), \"9\")), \" So, there\\u2019s the answer. Now go read that paper.\"), mdx(\"h2\", {\n    \"id\": \"conclusion\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"href\": \"#conclusion\",\n    \"aria-label\": \"conclusion permalink\",\n    \"className\": \"anchor before\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"Conclusion\"), mdx(\"p\", null, \"I won\\u2019t be taking over the world with this project\", mdx(\"sup\", _extends({\n    parentName: \"p\"\n  }, {\n    \"id\": \"fnref-10\"\n  }), mdx(\"a\", _extends({\n    parentName: \"sup\"\n  }, {\n    \"href\": \"#fn-10\",\n    \"className\": \"footnote-ref\"\n  }), \"10\")), \" but it demonstrates some interesting vectors. More security patches will be released, more creative hacks will arise; all it takes is a toehold and some creativity. Powerful new features make room for novel vulnerabilities. And so it goes.\"), mdx(\"p\", null, \"Regarding browsing history, reaction games probably aren\\u2019t your \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://en.wikipedia.org/wiki/Global_surveillance_disclosures_(2013%E2%80%93present)\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"biggest concern\"), \" anyway. I\\u2019ll just \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.eff.org/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"leave\"), \" \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.torproject.org/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"these\"), \" \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://tails.boum.org/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"here\"), \".\"), mdx(\"p\", null, \"And if you made it this far, just \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"/visited-vectors/reaction/\"\n  }), \"play the damn game already\"), \"!\"), mdx(\"h2\", {\n    \"id\": \"references\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"href\": \"#references\",\n    \"aria-label\": \"references permalink\",\n    \"className\": \"anchor before\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"References\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://hacks.mozilla.org/2010/03/privacy-related-changes-coming-to-css-vistited/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"Mozilla: privacy-related changes coming to CSS :visited\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"http://tinsnail.neocities.org/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"Who Am I\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"http://www.ieee-security.org/TC/SP2011/PAPERS/2011/paper010.pdf\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"I still know what you visited last summer\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"http://lcamtuf.blogspot.ca/2013/05/some-harmless-old-fashioned-fun-with-css.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"Defend your spaceship!\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"http://saizai.livejournal.com/960791.html\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"getComputedStyle benchmark\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"http://www.contextis.com/documents/2/Browser_Timing_Attacks.pdf\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"Pixel perfect timing attacks with HTML5\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"http://seclists.org/fulldisclosure/2011/Dec/65\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"Fast and somewhat reliable cache timing\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"http://arstechnica.com/security/2012/12/online-marketer-tapped-browser-flaw-to-see-if-visitors-were-pregnant/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"History-sniffing in the news (2012)\"))), mdx(\"h2\", {\n    \"id\": \"footnotes\",\n    \"style\": {\n      \"position\": \"relative\"\n    }\n  }, mdx(\"a\", _extends({\n    parentName: \"h2\"\n  }, {\n    \"href\": \"#footnotes\",\n    \"aria-label\": \"footnotes permalink\",\n    \"className\": \"anchor before\"\n  }), mdx(\"svg\", _extends({\n    parentName: \"a\"\n  }, {\n    \"aria-hidden\": \"true\",\n    \"focusable\": \"false\",\n    \"height\": \"16\",\n    \"version\": \"1.1\",\n    \"viewBox\": \"0 0 16 16\",\n    \"width\": \"16\"\n  }), mdx(\"path\", _extends({\n    parentName: \"svg\"\n  }, {\n    \"fillRule\": \"evenodd\",\n    \"d\": \"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"\n  })))), \"Footnotes\"), mdx(\"div\", {\n    \"className\": \"footnotes\"\n  }, mdx(\"hr\", {\n    parentName: \"div\"\n  }), mdx(\"ol\", {\n    parentName: \"div\"\n  }, mdx(\"li\", _extends({\n    parentName: \"ol\"\n  }, {\n    \"id\": \"fn-1\"\n  }), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"A noble effort, but it\\u2019s difficult to plug all the \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://arstechnica.com/security/2014/06/theyre-ba-ack-browser-sniffing-ghosts-return-to-haunt-chrome-ie-firefox/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"holes\"), \".\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"#fnref-1\",\n    \"className\": \"footnote-backref\"\n  }), \"\\u21A9\"))), mdx(\"li\", _extends({\n    parentName: \"ol\"\n  }, {\n    \"id\": \"fn-2\"\n  }), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"True under the assumption that the dataset is sparsely populated with \", mdx(\"code\", {\n    className: \"language-css\"\n  }, \":visited\"), \" links. If there is a high percentage of \", mdx(\"code\", {\n    className: \"language-css\"\n  }, \":visited\"), \" links in the set you\\u2019re actually better off with the linear algorithm. Good news: counting on a sparse dataset is a very safe bet.\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"#fnref-2\",\n    \"className\": \"footnote-backref\"\n  }), \"\\u21A9\"))), mdx(\"li\", _extends({\n    parentName: \"ol\"\n  }, {\n    \"id\": \"fn-3\"\n  }), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"I settled on n = 16 unique links per stack. Adding more links gives a performance hit, as it\\u2019s not easy for the browser to composite that many layers (each unique link requires 256 elements). 16 seems to be a sweet-spot.\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"#fnref-3\",\n    \"className\": \"footnote-backref\"\n  }), \"\\u21A9\"))), mdx(\"li\", _extends({\n    parentName: \"ol\"\n  }, {\n    \"id\": \"fn-4\"\n  }), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"We can win the same O(logn) complexity with a small optimization: if spacebar is hit on level n and then \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"not\"), \" on the left branch of level n + 1, we can immediately skip to level n + 2 since we know that our result is on the right side. This works because we only need to check for existence.\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"#fnref-4\",\n    \"className\": \"footnote-backref\"\n  }), \"\\u21A9\"))), mdx(\"li\", _extends({\n    parentName: \"ol\"\n  }, {\n    \"id\": \"fn-5\"\n  }), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Average human reaction time is just over 250ms, so we can safely budget 1s per frame-change.\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"#fnref-5\",\n    \"className\": \"footnote-backref\"\n  }), \"\\u21A9\"))), mdx(\"li\", _extends({\n    parentName: \"ol\"\n  }, {\n    \"id\": \"fn-6\"\n  }), mdx(\"code\", {\n    className: \"language-javascript\"\n  }, \"getComputedStyle\"), \" could process [200k-3.4M URLs/min][getcomputedstyle benchmark]. Our test is lucky to get 800 URLs/min.\", mdx(\"p\", {\n    parentName: \"li\"\n  }, mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"#fnref-6\",\n    \"className\": \"footnote-backref\"\n  }), \"\\u21A9\"))), mdx(\"li\", _extends({\n    parentName: \"ol\"\n  }, {\n    \"id\": \"fn-7\"\n  }), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"Some history-sniffing attacks focus on entirely different vectors; a common example is to \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://seclists.org/fulldisclosure/2011/Dec/65\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"request external resources and time the response\"), \", probabilistically determining whether the result was cached. All current approaches that I\\u2019ve found (including the ones discussed above) are timing attacks.\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"#fnref-7\",\n    \"className\": \"footnote-backref\"\n  }), \"\\u21A9\"))), mdx(\"li\", _extends({\n    parentName: \"ol\"\n  }, {\n    \"id\": \"fn-8\"\n  }), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"I created a quick demo \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://gist.github.com/rileyjshaw/abc13bd2d456669c7d5c\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"here\"), \" to inspect painting times in DevTools.\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"#fnref-8\",\n    \"className\": \"footnote-backref\"\n  }), \"\\u21A9\"))), mdx(\"li\", _extends({\n    parentName: \"ol\"\n  }, {\n    \"id\": \"fn-9\"\n  }), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"The coolest part of this paper is the second half; they implement OCR for cross-origin iframes using SVG filters. If you enjoyed my article at all (I assume you did since you made it this far) I \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"highly\"), \" recommend giving \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://www.contextis.com/documents/2/Browser_Timing_Attacks.pdf\",\n    \"target\": \"_blank\",\n    \"rel\": \"noopener noreferrer\"\n  }), \"Pixel perfect timing attacks with HTML5\"), \" a read. It\\u2019s at least 2 orders of magnitude cooler than my article.\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"#fnref-9\",\n    \"className\": \"footnote-backref\"\n  }), \"\\u21A9\"))), mdx(\"li\", _extends({\n    parentName: \"ol\"\n  }, {\n    \"id\": \"fn-10\"\n  }), mdx(\"p\", {\n    parentName: \"li\"\n  }, \"\\u2026but just wait until you see the next one.\", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"#fnref-10\",\n    \"className\": \"footnote-backref\"\n  }), \"\\u21A9\"))))));\n}\n;\nMDXContent.isMDXComponent = true;","fields":{"date":"November 12, 2014","slug":"/blog/stealing-history-with-CSS-binary-trees","title":"Stealing history with CSS binary trees"}}},"pageContext":{}},"staticQueryHashes":["3605882644"]}